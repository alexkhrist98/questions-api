# Тестовое задание на позицию Python developer
Этот репозиторий содержит в себе исходный код предложенного тестового задания. 
Результатом выполнения ТЗ является REST API, который принимает POST запросы с количеством запрашиваемых вопросов, подключается к стороннему API и записывает вопросы БД.

### Архитектура
Сервис реализован на основе принципов onion-архитектуры. 

### Технологии
- FastAPI;
- SQLAlchemy;
- PostgreSQL;
- HTTPX;
- Docker Compose.

## Как запустить проект?

### Требования
1. В системе установлены Docker и Docker Compose;
2. Установлена версия Python 3.11.

### 1. Клонируйте этот репозиторий
Для начала необходимо клонировать этот репозиторий. Для этого используйте:

```console
git clone http://github.com/alexkhrist98/questions-api
```
После этого перейдите в папку с исходным кодом:
```console
cd questions-api
```

### 2. Создайте и активируйте виртуальное окружение (для разработки)
Для разработки, необходимо настроить виртуальное окружение языка Python. В качестве такого окружения могут выступить poetry, birtualenv, pipenv. Наиболее простой способ - создать виртуальной окружение virtualenv:
```console
python -m virtualenv venv
```
Для активации виртуального окружения нужно ввести следующие команды:

**Для Windows**
```console
venv\scripts\activate
```

__Для Linux__
```console
source/bin/activate
```

После этого слева от рабочей дериктории появится обозначение **(venv)**, что свидетельствует об активации виртуального окружения.

### 3. Установите зависимости в виртуальное окружение (для разработки).
Чтобы иметь возможность работать с исходным кодом проекта, необходимо установить зависимости. Для этого используйте следующую команду:

```console
pip install -r requirements.txt
```

### 4. Настройте параметры контейнеров Docker. 
Для того, чтобы развернуть проект локально для тестирования или на сервере, необходимо настроить некоторые параметры контейнеров. Для этого можно воспользоваться файлом docker-compose.yml.

Данный docker-compose файл запускает 2 контейнера - контейнер приложения и базу данных PostgreSQL. Подробнее о настройке контейнера PostgreSQL можно узнать в [документации образа](https://hub.docker.com/_/postgres)

Для настройки контйнера с сервисом используются следующие переменные среды.
**1. DB_HOST** - домен или IP-адрес, на котором расположена база данных;
**2. DB_NAME** - имя базы данных;
**3. DB_PORT** - порт для подключения к базе данных;
**4. DB_USER** - имя пользователя для подключения к базе данных;
**5. DB_PASSWORD** - пароль для подключения к БД. 
**6. RELOAD** - флаг отвечает за перезагрузку сервиса в случае обнаружения изменений в исходном коде. Принимает True или False.
**7. DEBUG** - переменная позволяет включить дополнительные возможности для отладки. Принимает True или False;
**8. HOST** - адрес, на котором сервер принимает подключения к API;
**9. PORT** - порт, на котором сервер принимает подключения к API.

Эти переменные снабжены комментариями внутри docker-compose.yml, обращайте внимание на комментарии и представленные значения при изменении конфигурации контейнеров. 

### 5. Сборка образов и запуск контейнеров
Проверьте, что Docker и Docker Compose запущены, после чего введите команду:

```console
docker-compose up
```

Дождитесь, пока закончится сборка образов и развёртывание контейнеров.

### 6. Проверка работоспособности сервиса.
После запуска контейнеров вы можете отправить следующие запросы для проверки работоспособности сервиса:
**Важно!** Если проект запускается на удалённом сервере, не забудьте открыть на сервере нужные порты и заменить localhost на адрес удалённого сервера или домен.
```console
curl -X 'GET' \
  'http://localhost:8000/' \
  -H 'accept: application/json'
```

```console
curl -X 'POST' \
  'http://localhost:8000/questions' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "questions_num": 1
}'
```


